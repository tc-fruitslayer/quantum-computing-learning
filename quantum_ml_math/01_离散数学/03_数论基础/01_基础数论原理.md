# 基础数论原理


## 1. 整除性与同余理论

整除性是数论的基本概念，为同余理论和许多量子算法提供了理论基础。

### 1.1 整除性基本定理
- 定义：如果存在整数$k$使得$a = kb$，则称$b$整除$a$，记为$b \mid a$
- 带余除法：对任意整数$a$和正整数$b$，存在唯一的整数$q$和$r$，使得$a = bq + r$，其中$0 \leq r < b$
- 最大公因数(gcd)与最小公倍数(lcm)：$\gcd(a,b) \times \operatorname{lcm}(a,b) = |ab|$

### 1.2 同余理论
- 定义：若$a - b$是$m$的倍数，则称$a$同余于$b$模$m$，记为$a \equiv b \pmod{m}$
- 同余的性质：
  - 反身性：$a \equiv a \pmod{m}$
  - 对称性：若$a \equiv b \pmod{m}$，则$b \equiv a \pmod{m}$
  - 传递性：若$a \equiv b \pmod{m}$且$b \equiv c \pmod{m}$，则$a \equiv c \pmod{m}$
- 同余类：模$m$下的全体同余类形成剩余类环$\mathbb{Z}/m\mathbb{Z}$
- 完全剩余系：模$m$的完全剩余系是集合$\{0,1,2,\ldots,m-1\}$
- 简化剩余系：模$m$的简化剩余系是集合$\{r | 1 \leq r < m, \gcd(r,m)=1\}$

## 2. 素数与唯一分解定理

素数是数论的核心概念，唯一分解定理则是数论的基本定理，它们共同构成了许多量子算法的基础。

### 2.1 素数的基本性质
- 定义：大于$1$且只能被$1$和自身整除的正整数
- 素数的无限性：欧几里得证明
  - 假设素数有限，记为$p_1, p_2, \ldots, p_n$
  - 构造数$N = p_1 p_2 \cdots p_n + 1$
  - $N$不能被任何$p_i$整除，故$N$为素数或包含新的素因子
- 素数分布：素数定理表明$\pi(x) \sim \frac{x}{\ln x}$，其中$\pi(x)$表示不超过$x$的素数个数
- 素性测试：
  - 试除法：对于$n$，检查是否有素数$p \leq \sqrt{n}$使得$p | n$
  - Miller-Rabin测试：基于二次互反律的概率性测试

### 2.2 唯一分解定理
- 算术基本定理：每个大于$1$的整数$n$可以唯一地表示为素数的乘积：$n = p_1^{a_1} p_2^{a_2} \cdots p_k^{a_k}$
- 因式分解问题：
  - 经典算法：试除法、Pollard $p-1$、数域筛法等
  - 量子算法：Shor算法的渐近时间复杂度为$O((\log N)^3)$
- Shor算法的基本原理：
  - 将因式分解归约为周期查找：找到函数$f(x) = a^x \bmod N$的周期$r$
  - 利用量子傅里叶变换找到$r$，若$r$为偶数且$a^{r/2} \not\equiv -1 \pmod{N}$，则$\gcd(a^{r/2} \pm 1, N)$可能是$N$的非平凡因子
- 量子计算中的因式分解挑战：
  - 量子误差修正
  - 足够大的量子寄存器
  - 量子相干性保持

## 3. 数论函数及其性质

数论函数在分析整数性质和解决数论问题中起着关键作用，许多量子算法的设计涉及数论函数的性质。

### 3.1 算术函数
- 除数函数：$d(n)$表示$n$的正除数个数
  - 例如：$d(12) = 6$，因为$12$的正除数有$1,2,3,4,6,12$
  - 若$n = p_1^{a_1} p_2^{a_2} \cdots p_k^{a_k}$，则$d(n) = (a_1+1)(a_2+1)\cdots(a_k+1)$
- 欧拉函数：$\phi(n)$表示不超过$n$且与$n$互质的正整数个数
  - 计算公式：$\phi(n) = n \prod_{p|n} (1-\frac{1}{p})$
  - 例如：$\phi(10) = 10 \cdot (1-\frac{1}{2}) \cdot (1-\frac{1}{5}) = 10 \cdot \frac{1}{2} \cdot \frac{4}{5} = 4$
  - 欧拉定理：若$\gcd(a,n)=1$，则$a^{\phi(n)} \equiv 1 \pmod{n}$
- 莫比乌斯函数：$\mu(n)$在整数的因式分解中具有重要应用，定义为：
  $$\mu(n) = \begin{cases}
  1 & \text{若 } n = 1 \\
  (-1)^k & \text{若 } n \text{ 是 } k \text{ 个不同素数的乘积} \\
  0 & \text{若 } n \text{ 能被某个素数的平方整除}
  \end{cases}$$
- 算术函数的性质：
  - 加法性：若$\gcd(m,n)=1$，则$f(mn) = f(m) + f(n)$
  - 乘法性：若$\gcd(m,n)=1$，则$f(mn) = f(m) \cdot f(n)$
  - 例如：$\phi$和$\mu$都是乘法函数

### 3.2 莫比乌斯反演
- 若$F(n) = \sum_{d|n} f(d)$，则$f(n) = \sum_{d|n} \mu(\frac{n}{d})F(d)$
- 在量子算法设计中，莫比乌斯反演可用于简化复杂的求和问题
- 例如：由$F(n) = \sum_{d|n} d$反演得$n = \sum_{d|n} \mu(\frac{n}{d})F(d)$

## 参考文献

1. Hardy, G. H., & Wright, E. M. (2008). An Introduction to the Theory of Numbers
2. Ireland, K., & Rosen, M. (1990). A Classical Introduction to Modern Number Theory
3. Shor, P. W. (1997). Polynomial-Time Algorithms for Prime Factorization and Discrete Logarithms on a Quantum Computer
4. Ribenboim, P. (1996). The New Book of Prime Number Records

## 习题集

以下习题按照难度递增排列，旨在帮助巩固数论基础知识并培养解决问题的能力。

### 基础习题

1. **整除性基础**：证明若$a \mid b$且$a \mid c$，则对任意整数$x$和$y$，$a \mid (bx + cy)$。

2. **最大公因数**：计算$\gcd(124, 36)$和$\operatorname{lcm}(124, 36)$。

3. **同余关系**：求解$17x \equiv 3 \pmod{10}$中$x$的所有可能值。

4. **剩余类**：列出模$8$的所有不同剩余类，并确定模$8$的简化剩余系。

5. **素数判定**：使用试除法判断$97$是否为素数。

### 中级习题

6. **欧拉函数**：计算$\phi(36)$和$\phi(100)$，并验证$\phi(mn) = \phi(m)\phi(n)$是否对$m=12$和$n=5$成立。如果不成立，解释原因。

7. **费马小定理**：使用费马小定理计算$3^{218} \bmod 11$。

8. **中国剩余定理**：解线性同余方程组：
   \begin{align}
   x &\equiv 2 \pmod{3}\\
   x &\equiv 3 \pmod{5}\\
   x &\equiv 2 \pmod{7}
   \end{align}

9. **莫比乌斯函数**：计算$\mu(6)$、$\mu(15)$和$\mu(25)$。

10. **算术函数**：证明除数函数$d(n)$不是乘法函数。找出一个反例。

### 高级习题

11. **RSA加密基础**：Alice选择$p=11$和$q=17$作为RSA密码系统的素数，并选择$e=7$作为公钥指数。
    - 计算$n = pq$和$\phi(n)$
    - 计算私钥指数$d$
    - 如果消息$m=23$，计算其加密后的密文$c$
    - 验证解密过程可以恢复原始消息

12. **平方剩余**：判断$2$是否为模$11$的平方剩余。然后找出模$11$的所有平方剩余。

13. **欧拉准则**：使用欧拉准则判断$3$是否为模$17$的二次剩余。

14. **莫比乌斯反演**：使用莫比乌斯反演公式，从$F(n) = \sum_{d|n} d^2$推导出$f(n)$的表达式。

15. **数论在量子算法中的应用**：解释Shor算法中周期寻找如何依赖于模运算的性质，以及为什么这使得该算法在量子计算机上特别有效。

### 挑战题

16. **Riemann猜想与素数分布**：研究Riemann zeta函数$\zeta(s)$与素数分布的关系，并讨论Riemann猜想对密码学的潜在影响。

17. **格密码学基础**：考虑二维格$\Lambda$，其基为$b_1 = (1, 0)$和$b_2 = (0.5, 0.8)$。找出这个格中长度不超过$2$的所有向量，并讨论最短向量问题在后量子密码学中的重要性。

18. **量子相位估计与数论**：解释量子相位估计算法如何利用模运算性质来实现Shor算法中的周期查找，以及为什么经典计算机难以高效完成这一任务。

19. **连分数与丢番图逼近**：使用连分数找到$\pi = 3.14159...$的最佳有理逼近，其分母不超过$100$。讨论这种技术如何应用于密码分析。

20. **椭圆曲线密码学导论**：考虑在$\mathbb{Z}_{11}$上定义的椭圆曲线$y^2 = x^3 + 2x + 5$，找出曲线上的所有点并验证它们构成一个群。
